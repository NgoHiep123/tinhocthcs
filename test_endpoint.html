<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Test Google Apps Script Endpoint</title>
</head>
<body>
  <h1>Test Endpoint Google Apps Script</h1>
  <button onclick="testEndpoint()">Test Endpoint</button>
  <div id="result"></div>

  <script>
    const ENDPOINT = "https://script.google.com/a/macros/asianintlschool.edu.vn/s/AKfycbytwRuA512UKakrHpIoURxfAn8-h6XB8e2Gs-cah4gxZHC7-iJOJrl-Qeg_5O-XAfrNjA/exec";

    async function testEndpoint() {
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<p>ƒêang test...</p>';

      // Test data
      const testData = {
        student_name: 'Test Student',
        class_name: '6/1',
        quiz_id: 'K6_A1',
        score: 8,
        total: 10,
        duration: 120
      };

      const url = `${ENDPOINT}?student_name=${encodeURIComponent(testData.student_name)}&class_name=${encodeURIComponent(testData.class_name)}&quiz_id=${testData.quiz_id}&score=${testData.score}&total=${testData.total}&duration=${testData.duration}`;

      console.log('Testing URL:', url);

      try {
        // Th·ª≠ v·ªõi no-cors (nh∆∞ code hi·ªán t·∫°i)
        const response = await fetch(url, {
          method: 'GET',
          mode: 'no-cors'
        });

        resultDiv.innerHTML = `
          <p>‚úÖ Request ƒë√£ ƒë∆∞·ª£c g·ª≠i (no-cors mode)</p>
          <p>‚ö†Ô∏è Kh√¥ng th·ªÉ ƒë·ªçc response v√¨ no-cors</p>
          <p>üìù Ki·ªÉm tra Google Apps Script logs ƒë·ªÉ x√°c nh·∫≠n</p>
          <p>URL: ${url}</p>
        `;

        // Th·ª≠ v·ªõi cors ƒë·ªÉ xem c√≥ l·ªói g√¨ kh√¥ng
        try {
          const response2 = await fetch(url, {
            method: 'GET',
            mode: 'cors'
          });
          const text = await response2.text();
          resultDiv.innerHTML += `<p>‚úÖ Response (cors): ${text}</p>`;
        } catch (e) {
          resultDiv.innerHTML += `<p>‚ö†Ô∏è CORS error (expected): ${e.message}</p>`;
        }

      } catch (e) {
        resultDiv.innerHTML = `<p>‚ùå L·ªói: ${e.message}</p>`;
        console.error('Error:', e);
      }
    }
  </script>
</body>
</html>

