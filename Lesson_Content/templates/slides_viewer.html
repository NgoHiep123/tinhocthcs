<!-- Slides Viewer Component (for PPTX/Slide shows) -->
<div class="slides-viewer-container">
  <div class="flex items-center justify-between mb-4 p-4 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg">
    <div class="flex items-center gap-3">
      <span class="text-2xl">üìä</span>
      <div>
        <div class="font-bold text-gray-900">Slide B√†i Gi·∫£ng</div>
        <div class="text-sm text-gray-600" id="slideInfo">Slide 1 / {{TOTAL_SLIDES}}</div>
      </div>
    </div>
    <div class="flex items-center gap-3">
      <button onclick="previousSlide()" class="px-4 py-2 bg-gray-600 text-white rounded-lg font-bold hover:bg-gray-700 transition disabled:opacity-50 disabled:cursor-not-allowed" id="prevBtn">
        ‚Üê Tr∆∞·ªõc
      </button>
      <button onclick="nextSlide()" class="px-4 py-2 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed" id="nextBtn">
        Sau ‚Üí
      </button>
      <a href="{{SLIDES_URL}}" download class="px-4 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition">
        üì• T·∫£i
      </a>
      <button onclick="toggleFullscreen()" class="px-4 py-2 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition">
        ‚õ∂ To√†n m√†n h√¨nh
      </button>
    </div>
  </div>
  
  <!-- Slide Display Area -->
  <div id="slideContainer" class="bg-white rounded-lg shadow-2xl overflow-hidden relative" style="min-height: 600px;">
    <!-- Option 1: PowerPoint Embed (if hosted on OneDrive/SharePoint) -->
    <div id="pptEmbed" class="hidden">
      <iframe 
        src="{{SLIDES_EMBED_URL}}" 
        width="100%" 
        height="600px" 
        frameborder="0"
        allowfullscreen
      ></iframe>
    </div>
    
    <!-- Option 2: Google Slides Embed -->
    <div id="googleSlidesEmbed" class="hidden">
      <iframe 
        src="{{GOOGLE_SLIDES_URL}}/embed?start=false&loop=false&delayms=3000" 
        width="100%" 
        height="600px" 
        frameborder="0" 
        allowfullscreen="true" 
        mozallowfullscreen="true" 
        webkitallowfullscreen="true"
      ></iframe>
    </div>
    
    <!-- Option 3: Custom Slide Viewer (using converted images) -->
    <div id="customSlides" class="relative">
      <div class="flex items-center justify-center bg-gray-900 p-8" style="min-height: 600px;">
        <img id="currentSlide" 
             src="{{SLIDE_IMAGE_URL}}" 
             alt="Slide {{CURRENT_SLIDE}}"
             class="max-w-full max-h-[600px] object-contain rounded-lg shadow-xl"
             style="transition: opacity 0.3s ease;"
        >
      </div>
      
      <!-- Slide Thumbnails -->
      <div id="thumbnails" class="mt-4 flex gap-2 overflow-x-auto p-2 bg-gray-100 rounded-lg">
        <!-- Thumbnails will be generated by JavaScript -->
      </div>
      
      <!-- Slide Progress -->
      <div class="mt-3 w-full h-2 bg-gray-200 rounded-full overflow-hidden">
        <div id="slideProgress" class="h-full bg-gradient-to-r from-purple-600 to-indigo-600 transition-all" style="width: 0%"></div>
      </div>
    </div>
    
    <!-- Navigation Arrows Overlay -->
    <button onclick="previousSlide()" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center font-bold text-2xl transition">
      ‚Äπ
    </button>
    <button onclick="nextSlide()" class="absolute right-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center font-bold text-2xl transition">
      ‚Ä∫
    </button>
  </div>
  
  <!-- Slide Notes (if available) -->
  <div id="slideNotes" class="mt-4 p-4 bg-blue-50 rounded-lg hidden">
    <h4 class="font-bold text-blue-900 mb-2">üìù Ghi ch√∫ slide:</h4>
    <p id="notesContent" class="text-gray-700"></p>
  </div>
  
  <!-- Download Alternative -->
  <div class="mt-4 p-4 bg-gray-50 rounded-lg text-center">
    <p class="text-gray-700 mb-3">üí° T·∫£i v·ªÅ ƒë·ªÉ xem offline ho·∫∑c in ·∫•n:</p>
    <a href="{{SLIDES_URL}}" download class="inline-block px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg font-bold hover:from-purple-700 hover:to-indigo-700 transition shadow-lg">
      üì• T·∫£i Slide (PPTX)
    </a>
  </div>
</div>

<script>
  // Slide viewer configuration
  const slidesConfig = {
    type: '{{SLIDES_TYPE}}', // 'google', 'ppt', 'images'
    totalSlides: {{TOTAL_SLIDES}},
    currentSlide: 1,
    slides: {{SLIDES_DATA}}, // Array of slide image URLs or data
    notes: {{SLIDES_NOTES}} // Array of notes for each slide
  };
  
  // Initialize slides viewer
  function initSlidesViewer() {
    switch(slidesConfig.type) {
      case 'google':
        document.getElementById('googleSlidesEmbed').classList.remove('hidden');
        document.getElementById('customSlides').classList.add('hidden');
        break;
      case 'ppt':
        document.getElementById('pptEmbed').classList.remove('hidden');
        document.getElementById('customSlides').classList.add('hidden');
        break;
      case 'images':
      default:
        document.getElementById('customSlides').classList.remove('hidden');
        generateThumbnails();
        updateSlideDisplay();
        break;
    }
  }
  
  // Navigate to next slide
  function nextSlide() {
    if (slidesConfig.currentSlide < slidesConfig.totalSlides) {
      slidesConfig.currentSlide++;
      updateSlideDisplay();
    }
  }
  
  // Navigate to previous slide
  function previousSlide() {
    if (slidesConfig.currentSlide > 1) {
      slidesConfig.currentSlide--;
      updateSlideDisplay();
    }
  }
  
  // Go to specific slide
  function goToSlide(slideNumber) {
    if (slideNumber >= 1 && slideNumber <= slidesConfig.totalSlides) {
      slidesConfig.currentSlide = slideNumber;
      updateSlideDisplay();
    }
  }
  
  // Update slide display
  function updateSlideDisplay() {
    const currentSlideImg = document.getElementById('currentSlide');
    const slideInfo = document.getElementById('slideInfo');
    const slideProgress = document.getElementById('slideProgress');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    
    // Update image
    if (currentSlideImg && slidesConfig.slides[slidesConfig.currentSlide - 1]) {
      // Fade out
      currentSlideImg.style.opacity = '0';
      
      setTimeout(() => {
        currentSlideImg.src = slidesConfig.slides[slidesConfig.currentSlide - 1];
        currentSlideImg.alt = `Slide ${slidesConfig.currentSlide}`;
        // Fade in
        currentSlideImg.style.opacity = '1';
      }, 150);
    }
    
    // Update info
    if (slideInfo) {
      slideInfo.textContent = `Slide ${slidesConfig.currentSlide} / ${slidesConfig.totalSlides}`;
    }
    
    // Update progress bar
    if (slideProgress) {
      const progress = (slidesConfig.currentSlide / slidesConfig.totalSlides) * 100;
      slideProgress.style.width = progress + '%';
    }
    
    // Update buttons
    if (prevBtn) {
      prevBtn.disabled = slidesConfig.currentSlide === 1;
    }
    if (nextBtn) {
      nextBtn.disabled = slidesConfig.currentSlide === slidesConfig.totalSlides;
    }
    
    // Update thumbnails
    updateThumbnailsHighlight();
    
    // Show notes if available
    showSlideNotes();
  }
  
  // Generate thumbnails
  function generateThumbnails() {
    const thumbnailsContainer = document.getElementById('thumbnails');
    if (!thumbnailsContainer || !slidesConfig.slides) return;
    
    thumbnailsContainer.innerHTML = '';
    
    slidesConfig.slides.forEach((slideUrl, index) => {
      const thumb = document.createElement('div');
      thumb.className = 'flex-shrink-0 cursor-pointer transition hover:scale-105';
      thumb.onclick = () => goToSlide(index + 1);
      thumb.innerHTML = `
        <div class="relative">
          <img src="${slideUrl}" alt="Slide ${index + 1}" 
               class="w-32 h-24 object-cover rounded-lg border-2 border-gray-300 hover:border-purple-500"
               data-thumbnail="${index + 1}">
          <div class="absolute bottom-1 right-1 bg-black/70 text-white text-xs px-2 py-1 rounded">
            ${index + 1}
          </div>
        </div>
      `;
      thumbnailsContainer.appendChild(thumb);
    });
  }
  
  // Update thumbnail highlight
  function updateThumbnailsHighlight() {
    document.querySelectorAll('[data-thumbnail]').forEach(thumb => {
      const slideNum = parseInt(thumb.dataset.thumbnail);
      if (slideNum === slidesConfig.currentSlide) {
        thumb.classList.add('border-purple-600', 'border-4');
        thumb.classList.remove('border-gray-300', 'border-2');
      } else {
        thumb.classList.remove('border-purple-600', 'border-4');
        thumb.classList.add('border-gray-300', 'border-2');
      }
    });
  }
  
  // Show slide notes
  function showSlideNotes() {
    const notesContainer = document.getElementById('slideNotes');
    const notesContent = document.getElementById('notesContent');
    
    if (!notesContainer || !notesContent) return;
    
    const notes = slidesConfig.notes?.[slidesConfig.currentSlide - 1];
    
    if (notes && notes.trim()) {
      notesContent.textContent = notes;
      notesContainer.classList.remove('hidden');
    } else {
      notesContainer.classList.add('hidden');
    }
  }
  
  // Toggle fullscreen
  function toggleFullscreen() {
    const container = document.getElementById('slideContainer');
    if (!container) return;
    
    if (!document.fullscreenElement) {
      container.requestFullscreen().catch(err => {
        console.error('Fullscreen error:', err);
      });
    } else {
      document.exitFullscreen();
    }
  }
  
  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') {
      previousSlide();
    } else if (e.key === 'ArrowRight') {
      nextSlide();
    } else if (e.key === 'Escape' && document.fullscreenElement) {
      document.exitFullscreen();
    }
  });
  
  // Initialize on load
  window.addEventListener('DOMContentLoaded', initSlidesViewer);
</script>

<style>
  .slides-viewer-container {
    user-select: none;
  }
  
  #thumbnails::-webkit-scrollbar {
    height: 8px;
  }
  
  #thumbnails::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  
  #thumbnails::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
  }
  
  #thumbnails::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
</style>


